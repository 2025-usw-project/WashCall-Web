# iOS PWA 홈 화면 추가 가이드

## 📱 iOS에서 WashCall 푸시 알림 받는 방법

iOS 16.4 이상의 iPhone/iPad에서 WashCall의 푸시 알림을 받으려면 **반드시 홈 화면에 추가**해야 합니다.

---

## ✅ 사전 요구사항

### 1. iOS 버전 확인
- **iOS 16.4 이상** 필요
- 설정 → 일반 → 정보 → iOS 버전 확인

### 2. Safari 브라우저 사용
- **Safari**에서만 홈 화면 추가 가능
- Chrome, Firefox 등 다른 브라우저는 지원 안 됨

### 3. 개인정보 보호 모드 끄기
- Safari 개인정보 보호 브라우징 모드에서는 푸시 알림 지원 안 됨
- 일반 모드로 접속 필요

---

## 📋 홈 화면 추가 방법

### Step 1: Safari로 WashCall 접속
```
https://washcall.space
```

### Step 2: 공유 버튼 클릭
- Safari 하단의 **공유 버튼 📤** 클릭
- (또는 상단 주소창 왼쪽의 공유 아이콘)

### Step 3: "홈 화면에 추가" 선택
- 공유 메뉴에서 아래로 스크롤
- **"홈 화면에 추가"** 선택

### Step 4: 이름 확인 후 추가
- 앱 이름: **WashCall**
- 우측 상단 **"추가"** 버튼 클릭

### Step 5: 홈 화면에서 실행
- 홈 화면에 생성된 **WashCall** 아이콘 클릭
- **독립 앱 모드로 실행됨** (Safari 주소창 없이 실행)

---

## 🔔 푸시 알림 설정

### 홈 화면 앱에서 실행 후

1. **로그인**
2. **"🔔 빈자리 알림 받기"** 버튼 클릭
3. **알림 권한 허용** 선택
4. ✅ FCM 토큰 발급 완료!

---

## 🚨 주의사항

### ❌ Safari 브라우저 탭에서는 푸시 알림 안 됨
```
Safari 탭에서 실행 → ❌ 푸시 알림 없음
홈 화면 앱에서 실행 → ✅ 푸시 알림 정상 동작
```

### ❌ 개인정보 보호 모드에서는 알림 안 됨
- Safari 개인정보 보호 브라우징 → ❌
- 일반 Safari → ✅

### ✅ iOS 16.4+ 필수
- iOS 16.3 이하 → 푸시 알림 미지원
- iOS 16.4 이상 → 정상 동작

---

## 🔍 자주 묻는 질문 (FAQ)

### Q1: Safari에서 "홈 화면에 추가"가 안 보여요
**A**: 이미 홈 화면에 추가되어 있을 수 있습니다. 홈 화면을 확인해보세요.

### Q2: 홈 화면에 추가했는데 알림이 안 와요
**A**: 다음을 확인하세요:
1. iOS 16.4 이상인지 확인
2. **홈 화면 앱**으로 실행했는지 확인 (Safari 탭 아님)
3. 알림 권한이 허용되어 있는지 확인
   - 설정 → WashCall → 알림 → 허용

### Q3: Chrome이나 다른 브라우저로 접속했어요
**A**: iOS에서는 **Safari만** 홈 화면 추가 및 푸시 알림을 지원합니다.
   - Chrome/Firefox 등에서는 지원 안 됨
   - Safari로 다시 접속해주세요

### Q4: 알림 권한을 실수로 거부했어요
**A**: 설정에서 다시 허용할 수 있습니다:
   1. 설정 → WashCall
   2. 알림 → 허용으로 변경
   3. WashCall 앱 재시작

### Q5: 홈 화면 앱을 삭제하면 어떻게 되나요?
**A**: 다시 홈 화면에 추가하고 알림 권한을 다시 허용해야 합니다.

---

## 🛠️ 문제 해결

### "iOS 16.4 이상이 필요합니다" 메시지가 뜨는 경우
- iOS 업데이트 필요
- 설정 → 일반 → 소프트웨어 업데이트

### "알림 기능을 사용할 수 없습니다" 메시지
- Safari 개인정보 보호 모드를 끄고 다시 시도
- 새 탭에서 일반 모드로 접속

### FCM 토큰 발급 실패
- 홈 화면 앱으로 실행했는지 확인
- Safari 탭이 아닌 **홈 화면 아이콘**에서 실행
- 앱을 완전히 종료하고 다시 실행

---

## 📊 비교표

| 실행 방법 | Safari 탭 | 홈 화면 앱 |
|----------|-----------|------------|
| 푸시 알림 | ❌ 지원 안 됨 | ✅ 정상 동작 |
| 독립 실행 | ❌ 주소창 있음 | ✅ 전체 화면 |
| 오프라인 | ❌ 제한적 | ✅ 캐시 지원 |
| 아이콘 | 없음 | ✅ 홈 화면 |

---

## 🎯 최종 체크리스트

설치 및 알림 설정 전 확인:

- [ ] iOS 16.4 이상
- [ ] Safari 브라우저 사용
- [ ] 개인정보 보호 모드 끄기
- [ ] 홈 화면에 추가 완료
- [ ] 홈 화면 아이콘으로 앱 실행
- [ ] 로그인 완료
- [ ] "빈자리 알림 받기" 클릭
- [ ] 알림 권한 허용
- [ ] 콘솔에서 "✅ FCM 토큰 획득" 확인

---

## 💡 개발자용 디버깅

### 콘솔 메시지 확인
Safari DevTools (Mac 연결 필요):
1. Mac → Safari → 개발자용 → iPhone 선택
2. Console 탭에서 로그 확인

**정상 로그**:
```
✅ iOS 16.4 - 푸시 알림 지원
✅ iOS PWA 모드에서 실행 중 (푸시 알림 지원)
✅ FCM 토큰 획득 (iOS PWA 지원): eABCDEFGHIJK...
```

**오류 로그**:
```
❌ iOS 16.4 이상이 필요합니다. 현재: iOS 16.2
📱 iOS Safari에서 실행 중 → 홈 화면 추가 안내 표시
```

### 프롬프트 강제 표시
Safari DevTools Console에서:
```javascript
window.showPWAPromptManually();
```

### 프롬프트 초기화
```javascript
localStorage.removeItem('washcall_pwa_prompt_shown');
localStorage.removeItem('washcall_pwa_prompt_dismiss_count');
```

---

## 📞 지원

문제가 계속되면:
1. WashCall 서비스 담당자에게 문의
2. iOS 버전 및 오류 메시지 스크린샷 첨부
